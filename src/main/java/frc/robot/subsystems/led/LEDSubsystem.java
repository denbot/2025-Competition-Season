package frc.robot.subsystems.led;

import edu.wpi.first.wpilibj2.command.Subsystem;

import java.util.HashMap;
import java.util.Map;

/**
 * Represents individual LED pixels as WPILib {@link Subsystem}s.
 *
 * <p>This enum allows the Command Scheduler to manage LED resources. By treating LEDs as
 * subsystems, the scheduler automatically handles conflict resolution, ensuring only one
 * command controls a specific pixel at a time.
 */
public enum LEDSubsystem implements Subsystem {
  LED_0,
  LED_1,
  LED_2,
  LED_3,
  LED_4,
  LED_5,
  LED_6,
  LED_7,
  LED_8,
  LED_9,
  LED_10,
  LED_11,
  LED_12,
  LED_13,
  LED_14,
  LED_15,
  LED_16,
  LED_17,
  LED_18,
  LED_19,
  LED_20,
  LED_21,
  LED_22,
  LED_23,
  LED_24,
  LED_25,
  LED_26,
  LED_27,
  LED_28,
  LED_29,
  LED_30,
  LED_31,
  LED_32,
  LED_33,
  LED_34,
  LED_35,
  LED_36,
  LED_37,
  LED_38,
  LED_39,
  LED_40,
  LED_41,
  LED_42,
  LED_43,
  LED_44,
  LED_45,
  LED_46,
  LED_47,
  LED_48,
  LED_49,
  LED_50,
  LED_51,
  LED_52,
  LED_53,
  LED_54,
  LED_55,
  LED_56,
  LED_57,
  LED_58,
  LED_59,
  LED_60,
  LED_61,
  LED_62,
  LED_63,
  LED_64,
  LED_65,
  LED_66,
  LED_67,
  LED_68,
  LED_69,
  LED_70,
  LED_71,
  LED_72,
  LED_73,
  LED_74,
  LED_75,
  LED_76,
  LED_77,
  LED_78,
  LED_79,
  LED_80,
  LED_81,
  LED_82,
  LED_83,
  LED_84,
  LED_85,
  LED_86,
  LED_87,
  LED_88,
  LED_89,
  LED_90,
  LED_91,
  LED_92,
  LED_93,
  LED_94,
  LED_95,
  LED_96,
  LED_97,
  LED_98,
  LED_99,
  LED_100,
  LED_101,
  LED_102,
  LED_103,
  LED_104,
  LED_105,
  LED_106,
  LED_107,
  LED_108,
  LED_109,
  LED_110,
  LED_111,
  LED_112,
  LED_113,
  LED_114,
  LED_115,
  LED_116,
  LED_117,
  LED_118,
  LED_119,
  LED_120,
  LED_121,
  LED_122,
  LED_123,
  LED_124,
  LED_125,
  LED_126,
  LED_127,
  LED_128,
  LED_129,
  LED_130,
  LED_131,
  LED_132,
  LED_133,
  LED_134,
  LED_135,
  LED_136,
  LED_137,
  LED_138,
  LED_139,
  LED_140,
  LED_141,
  LED_142,
  LED_143,
  LED_144,
  LED_145,
  LED_146,
  LED_147,
  LED_148,
  LED_149,
  LED_150,
  LED_151,
  LED_152,
  LED_153,
  LED_154,
  LED_155,
  LED_156,
  LED_157,
  LED_158,
  LED_159,
  LED_160,
  LED_161,
  LED_162,
  LED_163,
  LED_164,
  LED_165,
  LED_166,
  LED_167,
  LED_168,
  LED_169,
  LED_170,
  LED_171,
  LED_172,
  LED_173,
  LED_174,
  LED_175,
  LED_176,
  LED_177,
  LED_178,
  LED_179,
  LED_180,
  LED_181,
  LED_182,
  LED_183,
  LED_184,
  LED_185,
  LED_186,
  LED_187,
  LED_188,
  LED_189,
  LED_190,
  LED_191,
  LED_192,
  LED_193,
  LED_194,
  LED_195,
  LED_196,
  LED_197,
  LED_198,
  LED_199,
  LED_200,
  LED_201,
  LED_202,
  LED_203,
  LED_204,
  LED_205,
  LED_206,
  LED_207,
  LED_208,
  LED_209,
  LED_210,
  LED_211,
  LED_212,
  LED_213,
  LED_214,
  LED_215,
  LED_216,
  LED_217,
  LED_218,
  LED_219,
  LED_220,
  LED_221,
  LED_222,
  LED_223,
  LED_224,
  LED_225,
  LED_226,
  LED_227,
  LED_228,
  LED_229,
  LED_230,
  LED_231,
  LED_232,
  LED_233,
  LED_234,
  LED_235,
  LED_236,
  LED_237,
  LED_238,
  LED_239,
  LED_240,
  LED_241,
  LED_242,
  LED_243,
  LED_244,
  LED_245,
  LED_246,
  LED_247,
  LED_248,
  LED_249,
  LED_250,
  LED_251,
  LED_252,
  LED_253,
  LED_254,
  LED_255;

  public static Map<Integer, LEDSubsystem> getLEDMap(int numberOfLEDs) throws MoreLEDsRequestedThanWeHave {
    if (numberOfLEDs > LEDSubsystem.values().length) {
      throw new MoreLEDsRequestedThanWeHave(numberOfLEDs);
    }

    Map<Integer, LEDSubsystem> result = new HashMap<>();

    for (int i = 0; i < numberOfLEDs; i++) {
      String name = "LED_" + i;
      result.put(i, LEDSubsystem.valueOf(name));
    }

    return result;
  }

  public static class MoreLEDsRequestedThanWeHave extends RuntimeException {
    public final int requestedLEDCount;
    public final int availableLEDCount;

    MoreLEDsRequestedThanWeHave(int requestedLEDCount) {
      super(
          "Requested " + requestedLEDCount + " LED Subsystems, but we only have " + LEDSubsystem.values().length + " available"
      );

      this.requestedLEDCount = requestedLEDCount;
      this.availableLEDCount = LEDSubsystem.values().length;
    }
  }
}
